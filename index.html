<!DOCTYPE html>

<html>
<head>
    <title>Batima HQ</title>
    <meta name="author" content="Guilherme P. Gonçalves"/>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" type="text/css" href="batimahq.css" />
    <link href='http://fonts.googleapis.com/css?family=Mate+SC' rel='stylesheet' type='text/css'>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="./turn.min.js"></script>
    <script type="text/javascript" src="http://www.google.com/jsapi"></script>

    <script type="text/javascript">
        function isPage(entry) {
            var title = entry.getTitle().getText();
            return title.toLocaleLowerCase().search("página") >= 0;
        }

        function buildMagazine(images) {
            for (var i = 0; i < images.length; i++) {
                var page = $("<img />").attr("src", images[i]);
                $("#batimahq").append(page);
            }

            $("#batimahq").turn({"page":2}).bind("start",
                            function(e, page) {
                                if (page.next === 1) {
                                    e.preventDefault();
                                }

                            });
            $(".p2").off("pressed");
        }

        function onBlogPostFetch(root) {
            var images = [];
            var entries = root.feed.getEntries();

            for (var i = 0; i < entries.length; i++) {
                if (isPage(entries[i])) {
                    var html = entries[i].getContent().getText();
                    var imgUrl = $(html).find("img[src*='feira+da+fruta']")
                                        .attr("src")
                                        .replace("s640", "s1600"); // max resolution

                    images.unshift(imgUrl);
                }
            }

            buildMagazine(images);
        }

        function getPages() {
            var service = new google.gdata.blogger.BloggerService();
            var feedUrl = "http://batimahq.blogspot.com.br/feeds/posts/default";

            service.getBlogPostFeed(feedUrl, onBlogPostFetch);
        }

        google.load("gdata", "1.x", { packages: ["blogger"]});
        google.setOnLoadCallback(getPages);
    </script>
</head>
<body>
    <div id="batimahq">
        <div id="dummy-first-page"></div>
        <div id="greeter-wrapper">
            <div id="greeter">
                <h1>Putaquepariu, uma HQ do Bátima!</h1>

                <noscript>
                    <h2>Rápido Róbin, ative o Javascript no seu navegador!</h2>
                    <p>Você precisa ter Javascript habilitado para ler estes quadrinhos!</p>
                </noscript>

                <h2>É simples, comissário:</h2>
                <p>Talentosos artistas se reuniram para adaptar a famosa redublagem <a href="http://www.youtube.com/watch?v=mYXXl7Hu6v4">Feira da Fruta</a> para quadrinhos.</p>
                <p>Embora os resultados estejam ficando muito bons, acredito que poderiam ser melhor divulgados: no momento, a HQ está sendo colocada página por página no blog <a href="http://batimahq.blogspot.com.br/">BátimaHQ</a>, o que dificulta um pouco a leitura.</p>
                <p>Por isso resolvi criar esta página. Tudo o que ela faz é, quando aberta, construir uma HQ virtual (a Globo já registrou "revista eletrônica") a partir das páginas postadas até o momento no blog dos artistas. Acredito que isso facilite bastante a leitura.</p>
                <p>Só para deixar claro: não participei de forma alguma na criação da HQ. Apenas tentei tornar sua leitura mais agradável, e se você chegou até aqui, recomendo que visite também o blog onde a arte original é postada.</p>
                <p>É só começar a ler ao lado, e pra virar as páginas basta clicar em um dos cantos!</p>

                <h2>Putaque... ma como?!</h2>
                <p>Caso você esteja se perguntando, esta página funciona assim: as páginas da HQ são extraídas direto do blog usando a API do Google para o Blogger, e a revista em si é montada usando <a href="http://turnjs.com">turn.js</a>, um plugin para JQuery.</p>
            </div>
        </div>
    </div>
</body>
</html>
